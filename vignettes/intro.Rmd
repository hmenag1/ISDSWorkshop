---
title: "Introduction to R"
author: "Jarad Niemi"
date: "`r Sys.Date()`"
output: 
  html_document:
    toc: true
  pdf_document:
    toc: true
vignette: >
  %\VignetteIndexEntry{Introduction to R}
  %\VignetteEngine{knitr::rmarkdown}
---


# Introduction to R

## Detailed introduction

For an extremely detailed introduction, please see

```{r, eval=FALSE}
help.start()
```

In this documentation, the above command will be executed at the command prompt, see below. 


## R interface

In contrast to many other statistical software packages that use a point-and-click interface, e.g. SPSS, JMP, Stata, etc, R has a command-line interface. The command line has a command prompt, e.g. `>`, see below.

```{r, eval=FALSE}
>
```

This means, that you will be entering commands on this command line and hitting enter to execute them, e.g. 

```{r, eval=FALSE}
help()
```

Use the **up arrow** to recover past commands.

```{r, eval=FALSE}
hepl()
help() # Use up arrow and fix
```


## R GUI (or [RStudio](http://www.rstudio.com/))

Most likely, you are using a graphical user interface (GUI) and therefore, in addition, to the command line, you also have a windowed version of R with some point-and-click options, e.g. File, Edit, and Help.

In particular, there is an editor to create a new R script. So rather than entering commands on the command line, you will write commands in the script and then send those commands to the command line using `Ctrl-R` (PC) or `Command-Enter` (Mac).

```{r}
a = 1 
b = 2
a+b
```

Multiple lines can be run in sequence by selecting them and then using `Ctrl-R` (PC) or `Command-Enter` (Mac).




## Intro Activity

One of the most effective ways to use this documentation is to cut-and-paste the commands into a script and then execute them. 

Cut-and-paste the following commands into a **new script** and then run those commands directly from the script using `Ctrl-R` (PC) or `Command-Enter` (Mac).

```{r}
x = 1:10
y = rep(c(1,2), each=5)
m = lm(y~x)
s = summary(m)
```

Now, look at the result of each line

```{r, eval=FALSE}
x
y
m
s
s$r.squared
```


When you have completed the activity, compare your results to the [solutions](intro-solution.html#introduction).





# Using R as a calculator

## Basic calculator operations

All basic calculator operations can be performed in R. 

```{r}
1+2
1-2
1/2
1*2
```

For now, you can ignore the [1] at the beginning of the line, we'll learn about that when we get to vectors. 


## Advanced calculator operations

Many advanced calculator operations are also available.

```{r}
(1+3)*2+100^2 # standard order of operations
sin(2*pi)
sqrt(4)
10^2
log(10)
log(10,base=10)
```



## Using variables

A real advantage to using R rather than a calculator (or calculator app) is the ability to store quantities using variables.

```{r}
a = 1
b = 2
a+b
a-b
a/b
a*b
```



## Using informative variable names

While using variables alone is useful, it is much more useful to use informative variables names.

```{r}
population = 1000
number_infected = 200
deaths = 3

death_rate = deaths / number_infected
attack_rate = number_infected / population

death_rate
attack_rate
```



## Calculator Activity

### [Bayes' Rule](http://en.wikipedia.org/wiki/Bayes%27_theorem)

Suppose an individual tests positive for a disease, what is the probability the individual has the disease? Let 

- $D$ indicates the individual has the disease
- $N$ means the individual does not have the disease
- $+$ indicates a positive test result
- $-$ indicates a negative test 

The above probability can be calculated using [Bayes' Rule](http://en.wikipedia.org/wiki/Bayes%27_rule):

\[ P(D|+) = \frac{P(+|D)P(D)}{P(+|D)P(D)+P(+|N)P(N)} = \frac{P(+|D)P(D)}{P(+|D)P(D)+(1-P(-|N))\times(1-P(D))} \]

where

- $P(+|D)$ is the [sensitivity](http://en.wikipedia.org/wiki/Sensitivity_and_specificity) of the test
- $P(-|N)$ is the [specificity](http://en.wikipedia.org/wiki/Sensitivity_and_specificity) of the test
- $P(D)$ is the [prevalence](http://en.wikipedia.org/wiki/Prevalence) of the disease

Calculate the probability the individual has the disease if the test is positive when

- the specificity of the test is 0.99, 
- the sensistivity of the test is 0.95, and
- the prevalence of the disease is 0.001.


When you have completed the activity, compare your results to the [solutions](intro-solution.html#calculator).

```{r, echo=FALSE}
# Put your answer here.
```



# Reading data into R

In this section, we will learn how to read in csv or Excel files into R. We focus on csv files because less can go wrong. 

## Changing your working directory

One of the first tasks after starting R is to change the working directory. To set,

- in RStudio: Session > Set Working Directory > Choose Directory... (Ctrl + Shift + H)
- in R GUI (Windows): File > Change Dir... 
- in R GUI (Mac): Misc > Change Working Directory...

Or, you can just run the following command
```{r, eval=FALSE}
setwd(choose.dir(getwd()))
```

Make sure you have write access to this directory. 

## Load the ISDSWorkshop package

Much of the functionality of R is contained in packages. The first time these packages are used, they need to be installed, e.g. 

```{r, eval=FALSE}
install.packages("ISDSWorkshop")
```

Once installed, they needed to loaded into the R session. 

```{r}
library(ISDSWorkshop)
```



## Start this workshop

This package contains a function to help you get started. 

```{r}
workshop()
```

This function did three things

1. It opened the workshop HTML outline
1. It created a GI.csv data file in your working directory
1. It created a set of .R scripts in your working directory. 


## Open an R script

As we progress through the workshop, the code for a particular module will be available in the R script for that module. 

In R, open the module called `intro.R` and scroll down to the `workshop()` command. From here on out, as I run commands you should run the commands as well by using Ctrl-R (Windows) or Command-Enter (Mac) with the appropriate line(s) highlighted. 

You will notice that nothing after a `#` will be evaluated by R. That is because the `#` character indicates a comment in the code. For example,

```{r}
# This is just a comment. 
1+1 # So is this
# 1+2
```




## Reading a csv file into R

csv stands for comma-separated value file and is a standard file format for data. To read this in to R, use 

```{r}
GI = read.csv("GI.csv")
```

This created a data.frame object in R called GI. 


## read.table

The read.table function is a much more general function for reading data into R and it has many options. We could have gotten the same results, if we had used the following code:

```{r, tidy=FALSE}
GI2 = read.table("GI.csv", 
                 header=TRUE, # There is a header.
                 sep=",")     # The column delimiter is a comma.
```

To check if they are equal, use the following

```{r}
all.equal(GI, GI2)
```



## Exploring the data set

There are a number of functions that will provide information about a data.frame. Here are a few:

```{r}
dim(GI)
names(GI)
summary(GI)
head(GI)
tail(GI)
```


### Reading an Excel xlsx file into R

Reading an Excel xlsx file into R is done using the `read.xlsx` function from the [xlsx](http://cran.r-project.org/web/packages/xlsx/index.html) R package. Unfortunately many scenarios can cause this process to not work. Thus, we do not focus on it in an introductory R course. When it works, it looks like this

```{r, eval=FALSE}
d = read.xlsx("filename.xlsx", sheetIndex=1)
```

or 
```{r, eval=FALSE}
d = read.xlsx("filename.xlsx", sheetName="sheetName")
```




## Activity 

If you brought your own Excel file, open it and save a sheet as a csv file in your working directory. If you brought your own csv file, save it in your working directory. 

Try to use the read.csv function to read it into R. There are a number of different options in the csv file that may be useful:

```{r, eval=FALSE, tidy=FALSE}
d = read.table("filename.csv", # Make sure to change filename>to your filename and 
                               # make sure you use the extension, e.g. .csv. 
               header = TRUE,  # If there is no header column, change TRUE to FALSE.
               sep =",",       # The column delimiter is a comma.
               skip = 0        # Skip this many lines before starting to read the file
               )
```





```{r, echo=FALSE}
# Put your answer here.
```

